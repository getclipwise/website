---
import FeaturesSection from "@/components/home/features-section.astro";
import FinalCtaSection from "@/components/home/final-cta-section.astro";
import HeroSection from "@/components/home/hero-section.astro";
import HowItWorksSection from "@/components/home/how-it-works-section.astro";
import PricingSection from "@/components/home/pricing-section.astro";
import PrivacySection from "@/components/home/privacy-section.astro";
import UseCasesSection from "@/components/home/use-cases-section.astro";
import RootLayout from "@/layouts/root-layout.astro";
import { siteConfig } from "@/lib/site-config";
import { formatPrice } from "@/utils/format-price";
import { interpolate } from "@/utils/interpolate";
import { getCollection } from "astro:content";

const pricingTiersRaw = await getCollection("pricingTiers");
const premiumTier = pricingTiersRaw.find((t) => t.data.tier === "premium")!;

const placeholders = {
  freeDailyLimit: siteConfig.pricing.freeDailyLimit,
  premiumPrice: formatPrice(premiumTier.data.price),
};

const features = (await getCollection("features")).map((entry) => entry.data);
const steps = (await getCollection("steps")).map((entry) => entry.data);
const useCases = (await getCollection("useCases")).map(
  (entry) => entry.data.label
);
const privacyHighlights = (await getCollection("privacyHighlights")).map(
  (entry) => entry.data.label
);
const pricingTiers = pricingTiersRaw.map((entry) => ({
  ...entry.data,
  features: entry.data.features.map((f) => interpolate(f, placeholders)),
}));
const trustBadges = (await getCollection("trustBadges")).map((entry) => ({
  ...entry.data,
  label: interpolate(entry.data.label, placeholders),
}));
---

<RootLayout
  seo={{
    title: "Webpage to Markdown for AI Prompts",
    description:
      "Chrome extension that converts any webpage to clean Markdown for AI prompts. Copy and paste into ChatGPT, Claude, Gemini, and more. Private and works offline.",
  }}
  structuredData={{
    type: "webapp",
    breadcrumbs: [{ name: "Home", path: "/" }],
    pricingTiers,
    features,
    steps,
  }}
>
  <main id="main-content">
    <HeroSection
      badge="Now available on Chrome Web Store"
      headline={{
        prefix: "Any webpage to",
        highlight: "AI-ready",
        suffix: "Markdown in one click",
      }}
      subheadline="One click turns any webpage into clean Markdown you can paste into ChatGPT, Claude, Gemini, and more. Removes clutter and keeps formatting."
      trustBadges={trustBadges}
    />

    <HowItWorksSection
      id="how-it-works"
      title="How it works"
      subtitle="Three simple steps. No setup."
      steps={steps}
    />

    <FeaturesSection
      id="features"
      title="Everything you need"
      subtitle="Powerful features designed for the AI workflow"
      features={features}
    />

    <UseCasesSection
      id="use-cases"
      title="Perfect for"
      subtitle="Supercharge your AI workflow"
      useCases={useCases}
    />

    <PrivacySection
      id="privacy"
      badgeText="Privacy First"
      title="Your data never leaves your browser"
      description="Clipwise AI processes everything locally. We can't see what you convert because the data never leaves your device."
      highlights={privacyHighlights}
    />

    <PricingSection
      id="pricing"
      title="Simple, transparent pricing"
      subtitle="Free forever. Upgrade when you need more."
      tiers={pricingTiers}
      disclaimer="Free daily conversions reset automatically every day."
    />

    <FinalCtaSection
      id="get-started"
      title="Ready to supercharge your AI workflow?"
      subtitle={`Start free with ${siteConfig.pricing.freeDailyLimit} conversions daily. Upgrade anytime for unlimited access.`}
      disclaimer="No account required â€¢ No credit card needed"
    />
  </main>
</RootLayout>
