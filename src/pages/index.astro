---
import FeaturesSection from "@/components/home/features-section.astro";
import FinalCtaSection from "@/components/home/final-cta-section.astro";
import HeroSection from "@/components/home/hero-section.astro";
import HowItWorksSection from "@/components/home/how-it-works-section.astro";
import PricingSection from "@/components/home/pricing-section.astro";
import PrivacySection from "@/components/home/privacy-section.astro";
import UseCasesSection from "@/components/home/use-cases-section.astro";
import RootLayout from "@/layouts/root-layout.astro";
import { siteConfig } from "@/lib/site-config";
import { interpolate } from "@/utils/interpolate";
import { getCollection } from "astro:content";

const pricingPlaceholders = {
  freeDailyLimit: siteConfig.pricing.freeDailyLimit,
};

const features = (await getCollection("features")).map((entry) => entry.data);
const steps = (await getCollection("steps")).map((entry) => entry.data);
const useCases = (await getCollection("useCases")).map(
  (entry) => entry.data.label
);
const privacyHighlights = (await getCollection("privacyHighlights")).map(
  (entry) => entry.data.label
);
const pricingTiers = (await getCollection("pricingTiers")).map((entry) => ({
  ...entry.data,
  features: entry.data.features.map((f) => interpolate(f, pricingPlaceholders)),
}));
const trustBadges = (await getCollection("trustBadges")).map((entry) => ({
  ...entry.data,
  label: interpolate(entry.data.label, pricingPlaceholders),
}));
---

<RootLayout
  seo={{ title: "Webpages to Markdown for AI" }}
  structuredData={{
    type: "webapp",
    breadcrumbs: [{ name: "Home", path: "/" }],
    pricingTiers,
    features,
  }}
>
  <main id="main-content">
    <HeroSection
      badge="Now available on Chrome Web Store"
      headline={{
        prefix: "Webpages to",
        highlight: "Markdown",
        suffix: "for AI",
      }}
      subheadline="Convert any webpage into clean, formatted Markdown with one click. Perfect for ChatGPT, Claude, Gemini, and other AI assistants."
      trustBadges={trustBadges}
    />

    <HowItWorksSection
      id="how-it-works"
      title="How it works"
      subtitle="Three simple steps. No configuration needed."
      steps={steps}
    />

    <FeaturesSection
      id="features"
      title="Everything you need"
      subtitle="Powerful features designed for the AI workflow"
      features={features}
    />

    <UseCasesSection
      id="use-cases"
      title="Perfect for"
      subtitle="Supercharge your AI workflow"
      useCases={useCases}
    />

    <PrivacySection
      id="privacy"
      badgeText="Privacy First"
      title="Your data never leaves your browser"
      description="Clipwise AI processes everything locally. We can't see what you convert because the data never leaves your device."
      highlights={privacyHighlights}
    />

    <PricingSection
      id="pricing"
      title="Simple, transparent pricing"
      subtitle="Start free. Upgrade when you need more."
      tiers={pricingTiers}
      disclaimer="Daily conversions reset at midnight in your timezone. Premium license works on up to 3 browsers."
    />

    <FinalCtaSection
      id="get-started"
      title="Ready to supercharge your AI workflow?"
      subtitle={`Start with ${siteConfig.pricing.freeDailyLimit} free conversions daily. Upgrade anytime for unlimited access.`}
      disclaimer="No account required â€¢ No credit card needed"
    />
  </main>
</RootLayout>
