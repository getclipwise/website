---
import { siteConfig } from "@/lib/site-config";
import type { PricingTier } from "@/types";
import { formatPrice } from "@/utils/format-price";
import { Icon } from "astro-icon/components";

type Props = PricingTier;

const { tier, name, tagline, price, priceSuffix, features, ctaLabel, ctaIcon } =
  Astro.props;

const isPremium = tier === "premium";
const badge = isPremium ? "Popular" : undefined;
const ctaHref = isPremium
  ? siteConfig.links.premiumCheckout
  : siteConfig.links.chromeWebStore;
---

<div
  class:list={[
    "relative flex flex-col overflow-hidden rounded-2xl bg-card p-6 md:p-8",
    {
      "border-2 border-primary": isPremium,
      border: !isPremium,
    },
  ]}
>
  {
    badge && (
      <div class="absolute -right-8 top-4 flex h-6 w-28 rotate-45 items-center justify-center bg-primary text-xs font-semibold text-primary-foreground">
        {badge}
      </div>
    )
  }
  <div class="mb-4">
    <h3 class="text-lg font-semibold">{name}</h3>
    <p class="mt-1 text-sm text-muted-foreground">
      {tagline}
    </p>
  </div>
  <div class="mb-6">
    <span class="text-4xl font-bold">{formatPrice(price)}</span>
    <span class="text-muted-foreground">{priceSuffix}</span>
  </div>
  <ul class="space-y-3 text-sm">
    {
      features.map((item) => (
        <li class="flex items-center gap-2">
          <Icon
            name="lucide:check"
            class="size-4 text-primary"
            aria-hidden="true"
          />
          <span>{item}</span>
        </li>
      ))
    }
  </ul>
  <div class="mt-auto pt-8">
    <a
      href={ctaHref}
      target="_blank"
      rel="noopener noreferrer"
      class:list={[
        "group inline-flex w-full items-center justify-center gap-2 rounded-xl border-2 border-primary px-6 py-3.5 font-semibold transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2",
        {
          "bg-primary text-primary-foreground shadow-lg shadow-primary/25 hover:scale-[1.02] hover:shadow-xl hover:shadow-primary/30":
            isPremium,
          "bg-transparent text-primary hover:bg-primary/5": !isPremium,
        },
      ]}
    >
      <Icon name={ctaIcon} class="size-5" aria-hidden="true" />
      {ctaLabel}
    </a>
  </div>
</div>
